TODO:
- shorten functions
- protect (eg.: gettimeofday())
- fix the bug that two threads try to access a fork at the same time (it freezes)!