TODO:
- protect (eg.: gettimeofday())
- write monitor function
- TEST!